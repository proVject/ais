import{_ as I,u as R,a as A,b as j,r as _,c as z,n as P,p as $,d as p,e as b,f as d,k as g,w as o,E as c,q as G,i as H,h as u,o as r,g as l,F as J,j as K,l as V,m as M}from"./index-fopiJ3eL.js";const O={key:0,class:"new-template"},Q={key:0},W=["src"],X={__name:"TemplateDetails",setup(Y){R();const f=G(),w=H(),D=A(),t=j(),v=_(null),h=_(null),a=_({name:"",description:"",tags:[],width:null,height:null,preview_image:null}),k={name:[{required:!0,message:"Обов'язкове поле"}],width:[{required:!0,message:"Обов'язкове поле"}],height:[{required:!0,message:"Обов'язкове поле"}]},C=n=>{const e=new FileReader;e.readAsDataURL(n),e.onload=m=>{v.value=m.target.result,a.value.preview_image=n}},U=async()=>{h.value.validate(async n=>{if(n)try{await t.updateCanvasTemplate(f.params.id,a.value),c.success({title:"Успіх",message:"Шаблон створено успішно"}),w.push({name:"Index"})}catch(e){c.error({title:"Помилка",message:e.message})}})},x=z(()=>t.canvasTemplateTags.map(n=>({value:n,label:n}))),N=async()=>{try{await t.getCanvasTemplateTags()}catch(n){c.error({message:n.message})}},F=async()=>{try{await t.getCanvasTemplateDetails(f.params.id),a.value.name=t.canvasTemplateDetails.name,a.value.width=Number.parseFloat(t.canvasTemplateDetails.width)||null,a.value.height=Number.parseFloat(t.canvasTemplateDetails.height)||null,a.value.description=t.canvasTemplateDetails.description,a.value.tags=t.canvasTemplateDetails.tags,v.value=t.canvasTemplateDetails.preview_image,a.value.preview_image=t.canvasTemplateDetails.preview_image}catch(n){c.error({message:n.message}),w.push({name:"Index"})}};return N(),F(),P(()=>{$.$reset()}),(n,e)=>{const m=u("el-input"),i=u("el-form-item"),B=u("el-option"),E=u("el-select"),T=u("el-input-number"),y=u("el-button"),L=u("el-upload"),S=u("el-form"),q=u("el-card");return d(D).isLoggedIn?(r(),p("div",O,[d(t).canvasTemplateDetailsLoading?(r(),p("h2",Q,"Завантаження...")):d(t).canvasTemplateDetails?(r(),g(q,{key:1},{header:o(()=>e[5]||(e[5]=[M("span",null,"Редагувати шаблон",-1)])),default:o(()=>[l(S,{ref_key:"formEl",ref:h,model:a.value,rules:k,"label-position":"top"},{default:o(()=>[l(i,{prop:"name",label:"Назва"},{default:o(()=>[l(m,{modelValue:a.value.name,"onUpdate:modelValue":e[0]||(e[0]=s=>a.value.name=s)},null,8,["modelValue"])]),_:1}),l(i,{prop:"description",label:"Опис"},{default:o(()=>[l(m,{resize:"none",rows:"4",type:"textarea",modelValue:a.value.description,"onUpdate:modelValue":e[1]||(e[1]=s=>a.value.description=s)},null,8,["modelValue"])]),_:1}),l(i,{prop:"tags",label:"Теги"},{default:o(()=>[l(E,{modelValue:a.value.tags,"onUpdate:modelValue":e[2]||(e[2]=s=>a.value.tags=s),multiple:"",filterable:"","default-first-option":"","reserve-keyword":!1},{default:o(()=>[(r(!0),p(J,null,K(x.value,s=>(r(),g(B,{key:s.value,label:s.label,value:s.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(i,{prop:"width",label:"Ширина"},{default:o(()=>[l(T,{min:"1",style:{width:"100%"},modelValue:a.value.width,"onUpdate:modelValue":e[3]||(e[3]=s=>a.value.width=s)},null,8,["modelValue"])]),_:1}),l(i,{prop:"height",label:"Висота"},{default:o(()=>[l(T,{min:"1",style:{width:"100%"},modelValue:a.value.height,"onUpdate:modelValue":e[4]||(e[4]=s=>a.value.height=s)},null,8,["modelValue"])]),_:1}),l(i,{prop:"preview_image",label:"Зображення","label-position":"left"},{default:o(()=>[l(L,{"show-file-list":!1,"before-upload":C,accept:"image/*"},{default:o(()=>[a.value.preview_image?(r(),p("img",{key:0,class:"upload-image",src:v.value},null,8,W)):(r(),g(y,{key:1,type:"primary"},{default:o(()=>e[6]||(e[6]=[V("Завантажити")])),_:1,__:[6]}))]),_:1})]),_:1}),l(y,{type:"primary",plain:"",loading:d(t).updateCanvasTemplateLoading,onClick:U},{default:o(()=>e[7]||(e[7]=[V("Оновити")])),_:1,__:[7]},8,["loading"])]),_:1},8,["model"])]),_:1})):b("",!0)])):b("",!0)}}},ee=I(X,[["__scopeId","data-v-72a85e20"]]);export{ee as default};
